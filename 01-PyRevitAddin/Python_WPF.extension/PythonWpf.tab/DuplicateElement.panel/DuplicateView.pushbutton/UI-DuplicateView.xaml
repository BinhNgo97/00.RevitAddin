<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Duplicate Views" Height="520" Width="780" WindowStartupLocation="CenterScreen" ResizeMode="NoResize">
  <Grid Margin="10">
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="230"/>
      <ColumnDefinition Width="10"/>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition Height="*"/>
      <RowDefinition Height="10"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Left controls -->
    <StackPanel Grid.Column="0" Grid.Row="0" Orientation="Vertical">
      <Button x:Name="bt_Duplicate" Content="Duplicate" Height="36" Margin="0,0,0,10"/>
      <Button x:Name="bt_DuplicateWithDetail" Content="Duplicate With Detail" Height="36" Margin="0,0,0,10"/>
      <Button x:Name="bt_DuplicateAsDependent" Content="Duplicate as a Dependent" Height="36" Margin="0,0,0,10"/>
      <!-- New: load selected views from Revit -->
      <Button x:Name="bt_Select" Content="Load Selected Views" Height="36" Margin="0,0,0,10"/>
      <Separator Margin="0,10,0,10"/>
      <Grid Margin="0,0,0,6">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="90"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <TextBlock Text="Find Text" VerticalAlignment="Center" Margin="0,0,6,0"/>
        <TextBox x:Name="tb_find" Grid.Column="1" Height="26" Margin="0" Padding="4,2"
                 VerticalContentAlignment="Center" HorizontalAlignment="Stretch"/>
      </Grid>
      <Grid Margin="0,0,0,6">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="90"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <TextBlock Text="Replace With" VerticalAlignment="Center" Margin="0,0,6,0"/>
        <TextBox x:Name="tb_replace" Grid.Column="1" Height="26" Margin="0" Padding="4,2"
                 VerticalContentAlignment="Center" HorizontalAlignment="Stretch"/>
      </Grid>
      <Grid Margin="0,0,0,6">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="90"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <TextBlock Text="Prefix" VerticalAlignment="Center" Margin="0,0,6,0"/>
        <TextBox x:Name="tb_prefix" Grid.Column="1" Height="26" Margin="0" Padding="4,2"
                 VerticalContentAlignment="Center" HorizontalAlignment="Stretch"/>
      </Grid>
      <Grid Margin="0,0,0,6">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="90"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <TextBlock Text="Suffix" VerticalAlignment="Center" Margin="0,0,6,0"/>
        <TextBox x:Name="tb_suffix" Grid.Column="1" Height="26" Margin="0" Padding="4,2"
                 VerticalContentAlignment="Center" HorizontalAlignment="Stretch"/>
      </Grid>
      <Button x:Name="bt_Rename" Content="Rename" Height="28" Margin="0,8,0,0"/>
      <!-- New: remove selected rows from the grid -->
      <Button x:Name="bt_Remove" Content="Remove Selected" Height="28" Margin="0,6,0,0"/>
    </StackPanel>

    <!-- DataGrid: duplicated views -->
    <DataGrid x:Name="dgViews"
              Grid.Column="2" Grid.Row="0"
              AutoGenerateColumns="False"
              CanUserAddRows="False" CanUserDeleteRows="False"
              IsReadOnly="False"
              SelectionMode="Extended" SelectionUnit="FullRow">
      <DataGrid.Columns>
        <DataGridTextColumn Header="View Name" Binding="{Binding ViewName}" Width="2*"/>
        <DataGridTemplateColumn Header="View Template" Width="*">
          <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
              <ComboBox ItemsSource="{Binding Templates}"
                        DisplayMemberPath="Name"
                        SelectedItem="{Binding SelectedTemplate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
            </DataTemplate>
          </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
      </DataGrid.Columns>
    </DataGrid>

    <!-- Footer -->
    <StackPanel Grid.ColumnSpan="3" Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
      <Button x:Name="bt_Cancel" Content="Close" Width="80" Height="28" Margin="0,10,0,0"/>
    </StackPanel>
  </Grid>
</Window>