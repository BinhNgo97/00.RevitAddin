<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Duplicate Element Type" Height="600" Width="1000" WindowStartupLocation="CenterScreen" Background="#0A98A2">
  
  <Grid Margin="10">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="10"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="10"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Top controls (three rows) -->
    <Grid Grid.Row="0">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="130"/>
        <ColumnDefinition Width="220"/>
        <ColumnDefinition Width="20"/>
        <ColumnDefinition Width="160"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
      <Grid.RowDefinitions>
        <RowDefinition Height="34"/>
        <RowDefinition Height="34"/>
        <RowDefinition Height="34"/>
      </Grid.RowDefinitions>

      <!-- Row 1: Category + Load Excel Data -->
      <TextBlock Grid.Row="0" Grid.Column="0" Text="Category" VerticalAlignment="Center" Foreground="White" FontWeight="Bold"/>
      <ComboBox Grid.Row="0" Grid.Column="1" Name="cmbCategories" Height="26" Margin="4,0" 
                DisplayMemberPath="Name" ItemsSource="{Binding Categories}" SelectedItem="{Binding SelectedCategory}"/>

      <TextBlock Grid.Row="0" Grid.Column="3" Text="Load Excel Data:" VerticalAlignment="Center" Foreground="White" FontWeight="Bold"/>
      <DockPanel Grid.Row="0" Grid.Column="4" LastChildFill="True">
        <Button Name="btnSelectExcel"
                Content="File Path"
                Height="26"
                Margin="0"
                MinWidth="110"
                HorizontalAlignment="Stretch"
                Background="#BFF088"
                Command="{Binding SelectExcelCommand}"/>
      </DockPanel>

      <!-- Row 2: Fa/El Type + Sheet Name + Import/Refresh + Update/Create -->
      <TextBlock Grid.Row="1" Grid.Column="0" Text="Fa/El-Type" VerticalAlignment="Center" Foreground="White" FontWeight="Bold"/>
      <ComboBox Grid.Row="1" Grid.Column="1" Name="cmbFaElType" Height="26" Margin="4,0"
            IsEditable="True" IsTextSearchEnabled="False"
            DisplayMemberPath="Name" ItemsSource="{Binding FaElTypes}" SelectedItem="{Binding SelectedFaEl}"/>

      <TextBlock Grid.Row="1" Grid.Column="3" Text="Sheet Name" VerticalAlignment="Center" Foreground="White" FontWeight="Bold"/>
      <DockPanel Grid.Row="1" Grid.Column="4" LastChildFill="False">
        <ComboBox Name="cmbSheets" Width="150" Height="26" Margin="0,0,8,0" 
                  ItemsSource="{Binding SheetNames}" SelectedItem="{Binding SelectedSheet}"/>
        <Button Name="btnImportData" Content="ImportData" Width="110" Height="30" Background="#BFF088" Margin="0,0,8,0"
                Command="{Binding ImportDataCommand}"/>
        <Button Name="btnRefresh" Content="Refresh Data" Width="130" Height="30" Background="#BFF088" Margin="0,0,8,0"
                Command="{Binding RefreshDataCommand}"/>
        <Button Name="btnUpdateSelected" Content="Update All" Width="120" Height="30"
                Background="#FFD700" Margin="0,0,8,0" Visibility="Visible"
                Command="{Binding UpdateAllCommand}"/>
        <Button Name="btnCreateAll" Content="Create All New" Width="130" Height="30"
                Background="#BFF088" Margin="0,0,0,0" Visibility="Visible"
                Command="{Binding CreateAllNewCommand}"/>
      </DockPanel>
    </Grid>

    <!-- Middle content: DataGrid -->
    <Grid Grid.Row="2">
      <GroupBox Header="Excel Data" Foreground="White" FontWeight="Bold" Padding="6" Background="#0A98A2" BorderBrush="White">
        <Border BorderThickness="2" BorderBrush="Black" Background="#B3B3B3">
          <DataGrid Name="dataGrid"
                    Background="#B3B3B3"
                    ItemsSource="{Binding DataTableDefaultView}"
                    AlternatingRowBackground="#C6C6C6"
                    CanUserAddRows="False"
                    CanUserDeleteRows="False"
                    RowHeaderWidth="30"
                    SelectionMode="Single"
                    SelectionUnit="FullRow"
                    AutoGenerateColumns="True">
            <DataGrid.Resources>
              <!-- Highlight any cell whose binding has a validation error (set from DataRow column errors) -->
              <Style TargetType="DataGridCell">
                <Style.Triggers>
                  <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="Background" Value="#FFF3CD"/> <!-- light amber -->
                    <Setter Property="BorderBrush" Value="#FFB200"/>
                  </Trigger>
                </Style.Triggers>
              </Style>
            </DataGrid.Resources>
            <DataGrid.Columns>
              <!-- Action column shows Status as button text -->
              <DataGridTemplateColumn Header="Action" Width="140" DisplayIndex="0">
                <DataGridTemplateColumn.CellTemplate>
                  <DataTemplate>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                      <Button Content="{Binding [Status]}"
                              Command="{Binding DataContext.ActionCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                              CommandParameter="{Binding}"/>
                    </StackPanel>
                  </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
              </DataGridTemplateColumn>
            </DataGrid.Columns>
          </DataGrid>
        </Border>
      </GroupBox>
    </Grid>

    <!-- Bottom: summary information -->
    <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right">
      <Button Name="btnExisting" Content="Existing: 0" Foreground="White" FontWeight="Bold" Margin="0,0,15,0" 
              VerticalAlignment="Center" Background="Transparent" BorderThickness="0" Cursor="Hand"/>
      <Button Name="btnUpdate" Content="Need Update: 0" Foreground="#FFD700" FontWeight="Bold" Margin="0,0,15,0" 
              VerticalAlignment="Center" Background="Transparent" BorderThickness="0" Cursor="Hand"/>
      <Button Name="btnNew" Content="New: 0" Foreground="#BFF088" FontWeight="Bold" Margin="0,0,15,0" 
              VerticalAlignment="Center" Background="Transparent" BorderThickness="0" Cursor="Hand"/>
      <Button Name="btnClose" Content="Close" Width="90" Height="34" Background="#BFF088"/>
    </StackPanel>
  </Grid>
</Window>